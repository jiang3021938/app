2026-02-07 09:45:29,086 - main - INFO - === Logging system initialized ===
2026-02-07 09:45:29,086 - main - INFO - Log file: logs/app_20260207_094529.log
2026-02-07 09:45:29,087 - main - INFO - Log level: INFO
2026-02-07 09:45:29,087 - main - INFO - Timestamp: 20260207_094529
2026-02-07 09:45:29,834 - main - INFO - Included router: routers.aihub.router
2026-02-07 09:45:29,858 - main - INFO - Included router: routers.auth.router
2026-02-07 09:45:29,920 - main - INFO - Included router: routers.documents.router
2026-02-07 09:45:30,070 - main - INFO - Included router: routers.extractions.router
2026-02-07 09:45:30,079 - main - INFO - Included router: routers.health.router
2026-02-07 09:45:30,100 - main - INFO - Included router: routers.lease_analysis.router
2026-02-07 09:45:30,169 - main - INFO - Included router: routers.payments.router
2026-02-07 09:45:30,200 - main - INFO - Included router: routers.settings.router
2026-02-07 09:45:30,248 - main - INFO - Included router: routers.storage.router
2026-02-07 09:45:30,276 - core.config - DEBUG - Read dynamic attribute stripe_secret_key from environment variable STRIPE_SECRET_KEY
2026-02-07 09:45:30,286 - main - INFO - Included router: routers.stripe_payments.router
2026-02-07 09:45:30,297 - main - INFO - Included router: routers.user.router
2026-02-07 09:45:30,350 - main - INFO - Included router: routers.user_credits.router
2026-02-07 09:45:30,351 - main - INFO - === Application startup initiated ===
2026-02-07 09:45:30,352 - services.database - DEBUG - [DB_OP] Starting database initialization
2026-02-07 09:45:30,352 - services.database - INFO - ðŸ”§ Starting database initialization...
2026-02-07 09:45:30,352 - core.database - INFO - Starting database initialization...
2026-02-07 09:45:30,352 - core.config - DEBUG - Read dynamic attribute database_url from environment variable DATABASE_URL
2026-02-07 09:45:30,352 - core.database - INFO - Normalizing database URL for async compatibility...
2026-02-07 09:45:30,353 - core.database - INFO - Creating async database engine...
2026-02-07 09:45:30,353 - core.database - INFO - Using QueuePool with connection pooling for non-Lambda environment
2026-02-07 09:45:30,413 - core.database - INFO - Database engine created successfully
2026-02-07 09:45:30,413 - core.database - INFO - Creating async session maker...
2026-02-07 09:45:30,413 - core.database - INFO - Async session maker created successfully
2026-02-07 09:45:30,413 - core.database - INFO - Database connection initialized successfully
2026-02-07 09:45:30,413 - services.database - INFO - ðŸ”§ Database connection initialized, now creating tables if tables not exist...
2026-02-07 09:45:30,414 - core.database - DEBUG - [DB_OP] Starting create_tables
2026-02-07 09:45:30,414 - core.database - INFO - ðŸ”§ Starting table creation...
2026-02-07 09:45:31,910 - core.database - INFO - Tables initialized successfully
2026-02-07 09:45:31,911 - core.database - DEBUG - [DB_OP] Create tables completed in 1.4974s
2026-02-07 09:45:31,971 - services.database - INFO - ðŸ”§ Table creation completed
2026-02-07 09:45:31,972 - services.database - INFO - Database initialized successfully
2026-02-07 09:45:31,972 - services.database - DEBUG - [DB_OP] Database initialization completed in 1.6204s
2026-02-07 09:45:31,972 - services.mock_data - INFO - mock_data directory not found, skipping mock initialization
2026-02-07 09:45:31,973 - services.database - DEBUG - [DB_OP] Starting database initialization
2026-02-07 09:45:31,973 - services.database - INFO - ðŸ”§ Starting database initialization...
2026-02-07 09:45:31,973 - core.database - INFO - Starting database initialization...
2026-02-07 09:45:31,973 - core.database - INFO - Database already initialized
2026-02-07 09:45:31,974 - services.database - INFO - ðŸ”§ Database connection initialized, now creating tables if tables not exist...
2026-02-07 09:45:31,974 - core.database - DEBUG - [DB_OP] Starting create_tables
2026-02-07 09:45:31,975 - core.database - INFO - Tables already initialized
2026-02-07 09:45:31,975 - services.database - INFO - ðŸ”§ Table creation completed
2026-02-07 09:45:31,976 - services.database - INFO - Database initialized successfully
2026-02-07 09:45:31,977 - services.database - DEBUG - [DB_OP] Database initialization completed in 0.0041s
2026-02-07 09:45:31,977 - core.config - DEBUG - Read dynamic attribute admin_user_id from environment variable ADMIN_USER_ID
2026-02-07 09:45:31,977 - core.config - DEBUG - Read dynamic attribute admin_user_email from environment variable ADMIN_USER_EMAIL
2026-02-07 09:45:32,409 - services.auth - DEBUG - Admin user 956410 already exists
2026-02-07 09:45:32,469 - main - INFO - === Application startup completed successfully ===
2026-02-07 09:45:43,955 - core.database - DEBUG - [DB_OP] Starting get_db session creation
2026-02-07 09:45:43,956 - core.database - DEBUG - [DB_OP] Database session created successfully in 0.0004s
2026-02-07 09:45:43,956 - routers.auth - INFO - [token/exchange] Received platform token exchange request
2026-02-07 09:45:43,956 - core.config - DEBUG - Read dynamic attribute oidc_issuer_url from environment variable OIDC_ISSUER_URL
2026-02-07 09:45:43,956 - routers.auth - DEBUG - [token/exchange] Verifying token with issuer: https://auth.atoms.dev/api/v1/oidc/platform/tokens/verify
2026-02-07 09:45:45,886 - httpcore.connection - DEBUG - connect_tcp.started host='auth.atoms.dev' port=443 local_address=None timeout=5.0 socket_options=None
2026-02-07 09:45:45,887 - core.database - DEBUG - [DB_OP] Starting get_db session creation
2026-02-07 09:45:45,887 - core.database - DEBUG - [DB_OP] Database session created successfully in 0.0002s
2026-02-07 09:45:45,888 - routers.auth - INFO - [token/exchange] Received platform token exchange request
2026-02-07 09:45:45,888 - routers.auth - DEBUG - [token/exchange] Verifying token with issuer: https://auth.atoms.dev/api/v1/oidc/platform/tokens/verify
2026-02-07 09:45:45,918 - httpcore.connection - DEBUG - connect_tcp.started host='auth.atoms.dev' port=443 local_address=None timeout=5.0 socket_options=None
2026-02-07 09:45:45,933 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x7efe34520520>
2026-02-07 09:45:45,933 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x7efe344215c0> server_hostname='auth.atoms.dev' timeout=5.0
2026-02-07 09:45:45,940 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x7efe34521750>
2026-02-07 09:45:45,941 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2026-02-07 09:45:45,941 - httpcore.http11 - DEBUG - send_request_headers.complete
2026-02-07 09:45:45,941 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2026-02-07 09:45:45,941 - httpcore.http11 - DEBUG - send_request_body.complete
2026-02-07 09:45:45,942 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2026-02-07 09:45:45,952 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x7efe345229e0>
2026-02-07 09:45:45,952 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x7efe34ef2540> server_hostname='auth.atoms.dev' timeout=5.0
2026-02-07 09:45:45,961 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x7efe34520d00>
2026-02-07 09:45:45,961 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2026-02-07 09:45:45,961 - httpcore.http11 - DEBUG - send_request_headers.complete
2026-02-07 09:45:45,961 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2026-02-07 09:45:45,962 - httpcore.http11 - DEBUG - send_request_body.complete
2026-02-07 09:45:45,962 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2026-02-07 09:45:45,971 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sat, 07 Feb 2026 17:45:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'x-response-time', b'0.001s'), (b'x-request-id', b'b91d9be18d65d806cf1bc58500d28991'), (b'cf-cache-status', b'DYNAMIC'), (b'Content-Encoding', b'gzip'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9ca4b3ee2a63b8d4-LAX')])
2026-02-07 09:45:45,973 - httpx - INFO - HTTP Request: POST https://auth.atoms.dev/api/v1/oidc/platform/tokens/verify "HTTP/1.1 200 OK"
2026-02-07 09:45:45,974 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2026-02-07 09:45:45,974 - httpcore.http11 - DEBUG - receive_response_body.complete
2026-02-07 09:45:45,974 - httpcore.http11 - DEBUG - response_closed.started
2026-02-07 09:45:45,975 - httpcore.http11 - DEBUG - response_closed.complete
2026-02-07 09:45:45,976 - httpcore.connection - DEBUG - close.started
2026-02-07 09:45:45,976 - httpcore.connection - DEBUG - close.complete
2026-02-07 09:45:45,976 - routers.auth - DEBUG - [token/exchange] Issuer response status: 200
2026-02-07 09:45:45,977 - routers.auth - DEBUG - [token/exchange] Issuer response body: {'success': True, 'data': {'exp': 1772991115, 'user_id': 956410, 'email': 'hotogems@gmail.com', 'pv': 0}, 'message': 'Platform token verified', 'code': 0, 'timestamp': '2026-02-07T17:45:45.968404'}
2026-02-07 09:45:45,978 - routers.auth - INFO - [token/exchange] Token verified, platform_user_id=956410, email=hotogems@gmail.com
2026-02-07 09:45:45,978 - routers.auth - INFO - [token/exchange] Admin user verified, issuing admin token without DB persistence
2026-02-07 09:45:45,978 - routers.auth - DEBUG - [token/exchange] Admin user object for token issuance: id=956410, email=hotogems@gmail.com, role=admin
2026-02-07 09:45:45,978 - core.config - DEBUG - Read dynamic attribute jwt_expire_minutes from environment variable JWT_EXPIRE_MINUTES
2026-02-07 09:45:45,979 - core.config - DEBUG - Read dynamic attribute jwt_secret_key from environment variable JWT_SECRET_KEY
2026-02-07 09:45:45,979 - core.config - DEBUG - Read dynamic attribute jwt_algorithm from environment variable JWT_ALGORITHM
2026-02-07 09:45:46,168 - core.auth - DEBUG - Authentication token created for user hash: a89dfb40
2026-02-07 09:45:46,169 - routers.auth - INFO - [token/exchange] Token issued successfully for user_id=956410, expires_at=2026-03-09 17:45:45.978973+00:00
2026-02-07 09:45:46,169 - core.database - DEBUG - [DB_OP] Database session cleanup after 0.2822s
2026-02-07 09:45:46,171 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sat, 07 Feb 2026 17:45:45 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'x-response-time', b'0.002s'), (b'x-request-id', b'd0dd0d34bf965a420a787325138fd9e2'), (b'cf-cache-status', b'DYNAMIC'), (b'Content-Encoding', b'gzip'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9ca4b3ee4a1108ee-LAX')])
2026-02-07 09:45:46,172 - httpx - INFO - HTTP Request: POST https://auth.atoms.dev/api/v1/oidc/platform/tokens/verify "HTTP/1.1 200 OK"
2026-02-07 09:45:46,172 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2026-02-07 09:45:46,173 - httpcore.http11 - DEBUG - receive_response_body.complete
2026-02-07 09:45:46,173 - httpcore.http11 - DEBUG - response_closed.started
2026-02-07 09:45:46,173 - httpcore.http11 - DEBUG - response_closed.complete
2026-02-07 09:45:46,174 - httpcore.connection - DEBUG - close.started
2026-02-07 09:45:46,174 - httpcore.connection - DEBUG - close.complete
2026-02-07 09:45:46,174 - routers.auth - DEBUG - [token/exchange] Issuer response status: 200
2026-02-07 09:45:46,174 - routers.auth - DEBUG - [token/exchange] Issuer response body: {'success': True, 'data': {'exp': 1772991115, 'user_id': 956410, 'email': 'hotogems@gmail.com', 'pv': 0}, 'message': 'Platform token verified', 'code': 0, 'timestamp': '2026-02-07T17:45:45.989812'}
2026-02-07 09:45:46,175 - routers.auth - INFO - [token/exchange] Token verified, platform_user_id=956410, email=hotogems@gmail.com
2026-02-07 09:45:46,175 - routers.auth - INFO - [token/exchange] Admin user verified, issuing admin token without DB persistence
2026-02-07 09:45:46,175 - routers.auth - DEBUG - [token/exchange] Admin user object for token issuance: id=956410, email=hotogems@gmail.com, role=admin
2026-02-07 09:45:46,176 - core.auth - DEBUG - Authentication token created for user hash: a89dfb40
2026-02-07 09:45:46,176 - routers.auth - INFO - [token/exchange] Token issued successfully for user_id=956410, expires_at=2026-03-09 17:45:46.176134+00:00
2026-02-07 09:45:46,177 - core.database - DEBUG - [DB_OP] Database session cleanup after 2.2215s
2026-02-07 09:56:07,958 - services.database - DEBUG - [DB_OP] Starting database close
2026-02-07 09:56:07,959 - core.database - INFO - Database connection closed and engine disposed
2026-02-07 09:56:07,959 - services.database - INFO - Database connections closed
2026-02-07 09:56:07,959 - services.database - DEBUG - [DB_OP] Database close completed in 0.0012s
